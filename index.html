<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Artificial Intelligence and Data Science</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root {
  --bg-dark:#0b1220;
  --bg-card:#2a3445;
  --green:#00c853;
  --text:#e5e7eb;
}
body {
  margin:0;
  font-family:"Segoe UI",Arial,sans-serif;
  background:linear-gradient(180deg,#0b1220,#111827);
  color:var(--text);
}
.hidden{display:none}
.center{height:100vh;display:flex;justify-content:center;align-items:center}
.box{background:#020617;padding:30px;border-radius:15px;width:320px;text-align:center}
input,button{
  width:100%;padding:12px;margin-bottom:12px;
  border:none;border-radius:8px
}
button{background:var(--green);color:white;cursor:pointer}
.error{color:#f87171;font-size:14px}

nav{
  background:var(--green);
  padding:15px 30px;
  display:flex;justify-content:space-between;align-items:center
}
.logo{font-size:22px;font-weight:bold;color:white}
nav ul{list-style:none;display:flex;gap:25px;margin:0;padding:0}
nav li{cursor:pointer;color:white}

.container{max-width:1100px;margin:auto;padding:40px 20px;text-align:center}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:25px}
.card{background:var(--bg-card);padding:30px;border-radius:20px}
.card h2{color:#38bdf8}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="login" class="center">
  <div class="box">
    <h2>üîê Login</h2>
    <input id="loginId" placeholder="Student ID">
    <button onclick="login()">Login</button>
    <p onclick="showRegister()" style="cursor:pointer;color:#38bdf8">Register</p>
    <div class="error" id="loginError"></div>
  </div>
</div>

<!-- REGISTER -->
<div id="register" class="center hidden">
  <div class="box">
    <h2>üìù Register</h2>
    <input id="regName" placeholder="Full Name">
    <input id="regId" placeholder="Student ID">
    <input id="regEmail" placeholder="Email">
    <button onclick="register()">Register</button>
    <p onclick="showLogin()" style="cursor:pointer;color:#38bdf8">Back to Login</p>
    <div id="regResult"></div>
  </div>
</div>

<!-- APP -->
<div id="app" class="hidden">

<nav>
  <div class="logo">ADS 250</div>
  <ul>
    <li onclick="showDashboard()">Home</li>
    <li onclick="showProfile()">Profile</li>
    <li onclick="showAdmin()">Admin</li>
    <li onclick="logout()">Logout</li>
  </ul>
</nav>

<!-- DASHBOARD -->
<div id="dashboard" class="container">
  <div class="grid">
    <div class="card">
      <h2>Spring Semester 2026</h2>
    </div>
  </div>
</div>

<!-- PROFILE -->
<div id="profile" class="container hidden">
  <div class="card">
    <h2>üë§ Profile</h2>
    <p id="profileData"></p>
  </div>
</div>

<!-- ADMIN -->
<div id="admin" class="container hidden">
  <div class="card">
    <h2>üîë Admin Reset</h2>
    <input id="adminPass" placeholder="Master Password">
    <input id="adminId" placeholder="Student ID">
    <button onclick="adminReset()">Reset OTP</button>
    <p id="adminResult"></p>
  </div>
</div>

</div>

<script>
const API="https://ads-auth.sifatraj280.workers.dev";
const MASTER_PASSWORD="ADMIN123"; // CHANGE THIS

function showLogin(){hideAll();login.style.display="flex"}
function showRegister(){hideAll();register.style.display="flex"}
function showDashboard(){hideAll();app.style.display="block";dashboard.style.display="block"}
function showProfile(){
  hideAll();app.style.display="block";profile.style.display="block";
  profileData.innerText=JSON.stringify(JSON.parse(sessionStorage.user),null,2)
}
function showAdmin(){hideAll();app.style.display="block";admin.style.display="block"}

function hideAll(){
  login.style.display=register.style.display="none";
  dashboard.style.display=profile.style.display=admin.style.display="none";
}

async function register(){
  const res=await fetch(API+"/register",{method:"POST",headers:{"Content-Type":"application/json"},
  body:JSON.stringify({
    name:regName.value,
    studentId:regId.value,
    email:regEmail.value
  })});
  const data=await res.json();
  regResult.innerText="OTP: "+data.otp;
}

async function login(){
  const otp=prompt("Enter OTP");
  const res=await fetch(API+"/login",{method:"POST",headers:{"Content-Type":"application/json"},
  body:JSON.stringify({studentId:loginId.value,otp})});
  const data=await res.json();
  if(!res.ok){loginError.innerText=data.error;return}
  alert("New OTP: "+data.newOtp);
  sessionStorage.user=JSON.stringify({id:loginId.value});
  showDashboard();
}

function logout(){
  sessionStorage.clear();
  location.reload();
}

function adminReset(){
  if(adminPass.value!==MASTER_PASSWORD){
    adminResult.innerText="Wrong master password";
    return;
  }
  adminResult.innerText="Manual reset required in KV (backend secure)";
}
</script>

</body>
</html>
